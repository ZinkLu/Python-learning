# 目标
> 理解为主
- **用户**和**权限**的基本概念
- **用户管理** 终端命令
- **组管理** 终端命令
- **修改权限** 终端命令

<br/>
<br/>
<br/>

## 1、用户 和 权限的基本概念

### 1.1 基本概念
- **用户**是Linux系统工作中重要的一环，用户管理包括**用户**与**组**管理
- 在Linux系统中，不论是有本机还是远程登用权限录系统，每个系统都必须**拥有一个账号**，并且对不同的系统资源拥有不同的**使用权限**
- 对**文件/目录**的权限包括：
    序号|权限|英文|缩写|数字代号
    ---|---|---|---|---
    01 | 读 | read | r | 4
    02 | 写 | write | w | 2
    03 | 执行 | excute | x | 1

### 1.2 组
- 为了方便用户管理，提出了**组**的概念
    > 同一组内用户拥有相同权限

### 1.3 ls -l 拓展
- `ls -l`查看文件夹下文件的详细信息，从左到右：
    - **权限**，第一个字符是`d`代表目录
    - **硬连接数**，有多少种方式可以访问到当前目录/文件
    - **拥有者**，当前用户
    - **组**
    - **大小**
    - **时间**
    - **名称**

>关于权限的解读
> - 第一个字代表是是目录还是文件
> - 随后每三个字符代表着不同的权限，依次是：
>   - 拥有者权限
>   - 组权限
>   - 其他用户权限

### 1.4 chmod（重要）
- `chmod`可以修改**用户/组**对**文件/目录**的权限
- 命令格式：
    - 选项[u/g/o/a]代表 user/group/other/all 
    ```sh
    $chmod [u/g/o/a]+/-rwx 文件名|目录名
    ```
### 1.5 超级用户
> Linux系统中的`root`账号通常用于系统的**维护和管理**，对操作系统的所有资源具有访问权限。<br>
> 不推荐直接用root账号登录系统。<br>
> 系统会自动创建一个用户账号，称为‘标准用户’。

**sudo**
- `su`是`substitute user`缩写，表示使用另一个身份登录
- `sudo`命令用来以其他身份来执行命令，预设的身份为`root`
- `sudo`后输入密码，系统则会给**5分钟**的权限
- 切换到管理员身份`sudo -s`
- 退出管理员身份`exit`

> 若其未经授权的用户企图使用`sudo`，则会发出警告邮件给管理员

<br/>
<br/>
<br/>

## 2、组管理 终端命令
> *tip：需要`sudo`来执行*

序号 | 命令 | 作用
--- | --- | ---
01 | groupadd 组名 | 添加组
02 | groupdel 组名 | 删除组
03 | cat etc/group | 确认组信息
04 | chgrp -R 组名 文件/目录名 | 修改文件/目录的所属组

> `/etc`目录专门保存**系统配置信息**

==改变文件或者目录的组名，是否意味着文件或者目录只能同时属于一个组==

```
graph LR
添加组-->设置组权限
设置组权限-->添加组成员

```
<br/>
<br/>
<br/>

## 3、用户管理 终端命令
> *tip：需要`sudo`来执行*

### 3.1 创建用户/设置密码/删除用户
序号 | 命令 | 作用 | 说明
---|---|---|---
01 | useradd -m -g 组 新建用户名 | 添加新用户 |   -m 自动建立用户home目录 <br/> -g 指定用户所在的组，否则会建立一个同名的组
02 | passwd 用户名 | 设置用户密码 | 如果是普通用户，直接用passwd可以修改自己的账户密码
03 | userdel -r 用户名 | 删除用户 | -r 选项会自动删除home目录
04 | cat etc/passwd | grep 用户名 | 确认用户信息 <br/>用户信息保存在 etc/passwd中

### 3.2 查看用户信息

序号 | 命令 | 作用
---|---|---
01 | id[用户名] | 查看用户UID和GID信息
02 | who | 查看当前所有登陆的用户列表
03 | whoami | 查看当前登录用户的账户名

**passwd文件**
`/etc/passwd`文件存放的是用户信息，由6个分号组成的7个信息，分别是：

1. 用户名
2. 密码（x表示加密）
3. UID 用户标识
4. GID 组标识
5. 用户全名或本地账号
6. home目录
7. 登录使用的shell（登陆之后使用的终端命令），默认为`dash`（和`dash`只差一个字）

**usermod命令**
- `usermod`可以用来设置**用户**的**主组/附加组**和**登录shell**
- **主组**：通常在新建用户时指定，在`etc/passwd`的第4列**GID对应的组**
- **附加组**：在`etc/group`中最后一列表示该组的用户列表，用于指定用户的**附加权限**
> tip：设置了用户的附加组之后，需要重新登录才能生效

```
# 修改用户的主组（passwd中的GID）
usermod -g 组 用户名

#修改用户的附加组（新用户没有附加组，没有sudo权限）
usermod -G 组 用户名

#修改用户登录shell
usermod -s /bin/bash 用户名
```

**which命令（命令）**
> tips:
> - `/etc/passwd`是保存用户信息的文件
> - `usr/bin/passwd`是用于修改用户密码的程序

- `which`命令可以查看执行命令**所在位置**

**bin和sbin**
- 在`Linux`中，绝大多数可行性文件保存在`/bin`、`/sbin`、`/usr/bin`、`/usr/sbin`中
    - `/bin`(`binary`)是二进制执行文件目录，主要用于具体应用
    - `/sbin`(`system binary`)是系统管理员专用的二进制代码存放目录，主要用于系统管理
    - `/usr/sbin`(`user commands for applications`)后期安装的一些软件
    - `/sbin`(`spuer user commands for applications`)超级用户的一些管理程序

### 3.3 切换用户

序号 | 命令 | 作用 | 说明
--- | --- | --- | ---
01 | su -用户名 | 切换用户 | ‘-’可以切换到用户的home目录下，不写的话则保持当前位置
02 | exit | 退出当前用户 | 

- `su`后面不加任何参数则切换到`root`，这样十分不安全
- `exit`逐级退出

<br/>
<br/>
<br/>

## 4、修改文件权限
序号 | 命令 | 作用
--- | --- | ---
01 | chown | 修改拥有者
02 | chgrp | 修改组
03 | chmod | 修改权限

> `ls -l`中将权限分了**3列**显示，以上三个命令分别对应3列权限

- 命令格式：
```
# 修改文件|目录的所有者
chown 用户名 文件名|目录名 

#递归修改文件|目录的组
chgrp -R 文件名|目录名

#递归修改文件权限
chmod -R 755 文件名|目录名
```
- 在`chmod`命令中，后面的三个数字以此表示：1、拥有者权限 2、组权限  3、其他权限

- `chmod -R 755 文件名|目录名`中数字所具体代表的含义：
    - r/可读权限 = 4
    - w/可写权限 = 2
    - x/可执行权限 = 1
    - 例如：
        - rwx = 4+2+1 = 7
        - rw- = 4+2+0 = 6
        - r-x = 4+0+1 = 5
        - r-- = 4+0+0 = 4
        - -wx = 0+2+1 = 3
        - -w- = 0+2+0 = 2
        - --x = 0+0+1 = 1
        - --- = 0+0+0 = 0

- 常见的数字组合：
    - `777` == rwx|rwx|rwx
    - `755` == rwx|r-x|r-x
    - `644` == rw-|r--|r--